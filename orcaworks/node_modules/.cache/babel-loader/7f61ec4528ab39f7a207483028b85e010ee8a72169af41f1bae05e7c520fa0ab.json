{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useBudget}from'../../context/BudgetContext';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const EditItemModal=()=>{const{currentItem,setShowEditItemModal,addItem,updateItem,deleteItem,formatCurrency}=useBudget();const[formData,setFormData]=useState({MATERIAL:'',UNIDADE:'',QTD:0,VALOR_UNITARIO:0,VALOR:0});useEffect(()=>{if(currentItem&&currentItem.item){setFormData({...currentItem.item});}},[currentItem]);const handleChange=e=>{const{name,value}=e.target;const numValue=name==='QTD'||name==='VALOR_UNITARIO'?parseFloat(value):value;setFormData(prev=>{const newData={...prev,[name]:numValue};// Calculate total value if QTD or VALOR_UNITARIO changes\nif(name==='QTD'||name==='VALOR_UNITARIO'){const qty=name==='QTD'?numValue:prev.QTD;const unitPrice=name==='VALOR_UNITARIO'?numValue:prev.VALOR_UNITARIO;newData.VALOR=parseFloat((qty*unitPrice).toFixed(2));}return newData;});};const handleSubmit=e=>{e.preventDefault();if(!formData.MATERIAL||!formData.UNIDADE){alert('Preencha todos os campos obrigatórios');return;}if(currentItem.isNew){addItem(currentItem.chapterKey,formData);}else{updateItem(currentItem.chapterKey,currentItem.item.id,formData);}setShowEditItemModal(false);};const handleDelete=()=>{if(window.confirm('Tem certeza que deseja excluir este item?')){deleteItem(currentItem.chapterKey,currentItem.item.id);setShowEditItemModal(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 px-6 py-4 border-b border-gray-200 rounded-t-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-lg font-semibold text-gray-800\",children:[currentItem!==null&&currentItem!==void 0&&currentItem.isNew?'Adicionar Item':'Editar Item',\" - \",currentItem===null||currentItem===void 0?void 0:currentItem.chapterKey]}),/*#__PURE__*/_jsx(\"button\",{className:\"text-gray-500 hover:text-gray-700\",onClick:()=>setShowEditItemModal(false),children:\"\\xD7\"})]})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"MATERIAL\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"MATERIAL\",value:formData.MATERIAL,onChange:handleChange,className:\"form-input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"UNIDADE\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"UNIDADE\",value:formData.UNIDADE,onChange:handleChange,className:\"form-input\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"QUANTIDADE\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"QTD\",value:formData.QTD,onChange:handleChange,className:\"form-input\",min:\"0\",step:\"0.01\",required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"VALOR UNIT\\xC1RIO\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"VALOR_UNITARIO\",value:formData.VALOR_UNITARIO,onChange:handleChange,className:\"form-input\",min:\"0\",step:\"0.01\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"VALOR TOTAL\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formatCurrency(formData.VALOR),className:\"form-input bg-gray-100\",readOnly:true}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-xs text-gray-500\",children:\"(calculado)\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:()=>setShowEditItemModal(false),children:\"Cancelar\"}),!(currentItem!==null&&currentItem!==void 0&&currentItem.isNew)&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-danger\",onClick:handleDelete,children:\"Excluir\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:currentItem!==null&&currentItem!==void 0&&currentItem.isNew?'Adicionar':'Salvar Alterações'})]})]})]})});};export default EditItemModal;","map":{"version":3,"names":["React","useState","useEffect","useBudget","jsxs","_jsxs","jsx","_jsx","EditItemModal","currentItem","setShowEditItemModal","addItem","updateItem","deleteItem","formatCurrency","formData","setFormData","MATERIAL","UNIDADE","QTD","VALOR_UNITARIO","VALOR","item","handleChange","e","name","value","target","numValue","parseFloat","prev","newData","qty","unitPrice","toFixed","handleSubmit","preventDefault","alert","isNew","chapterKey","id","handleDelete","window","confirm","className","children","onClick","onSubmit","type","onChange","required","min","step","readOnly"],"sources":["/mnt/c/Users/titob/OneDrive - Ensino Lusófona/EXO/repo-tito/construsud/orcaworks/src/components/modals/EditItemModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useBudget } from '../../context/BudgetContext';\n\nconst EditItemModal = () => {\n  const { \n    currentItem, \n    setShowEditItemModal, \n    addItem, \n    updateItem, \n    deleteItem,\n    formatCurrency\n  } = useBudget();\n  \n  const [formData, setFormData] = useState({\n    MATERIAL: '',\n    UNIDADE: '',\n    QTD: 0,\n    VALOR_UNITARIO: 0,\n    VALOR: 0\n  });\n  \n  useEffect(() => {\n    if (currentItem && currentItem.item) {\n      setFormData({\n        ...currentItem.item\n      });\n    }\n  }, [currentItem]);\n  \n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    const numValue = name === 'QTD' || name === 'VALOR_UNITARIO' ? parseFloat(value) : value;\n    \n    setFormData(prev => {\n      const newData = { ...prev, [name]: numValue };\n      \n      // Calculate total value if QTD or VALOR_UNITARIO changes\n      if (name === 'QTD' || name === 'VALOR_UNITARIO') {\n        const qty = name === 'QTD' ? numValue : prev.QTD;\n        const unitPrice = name === 'VALOR_UNITARIO' ? numValue : prev.VALOR_UNITARIO;\n        newData.VALOR = parseFloat((qty * unitPrice).toFixed(2));\n      }\n      \n      return newData;\n    });\n  };\n  \n  const handleSubmit = (e) => {\n    e.preventDefault();\n    \n    if (!formData.MATERIAL || !formData.UNIDADE) {\n      alert('Preencha todos os campos obrigatórios');\n      return;\n    }\n    \n    if (currentItem.isNew) {\n      addItem(currentItem.chapterKey, formData);\n    } else {\n      updateItem(currentItem.chapterKey, currentItem.item.id, formData);\n    }\n    \n    setShowEditItemModal(false);\n  };\n  \n  const handleDelete = () => {\n    if (window.confirm('Tem certeza que deseja excluir este item?')) {\n      deleteItem(currentItem.chapterKey, currentItem.item.id);\n      setShowEditItemModal(false);\n    }\n  };\n  \n  return (\n    <div className=\"modal-overlay\">\n      <div className=\"modal-content\">\n        <div className=\"bg-gray-100 px-6 py-4 border-b border-gray-200 rounded-t-lg\">\n          <div className=\"flex justify-between items-center\">\n            <h2 className=\"text-lg font-semibold text-gray-800\">\n              {currentItem?.isNew ? 'Adicionar Item' : 'Editar Item'} - {currentItem?.chapterKey}\n            </h2>\n            <button\n              className=\"text-gray-500 hover:text-gray-700\"\n              onClick={() => setShowEditItemModal(false)}\n            >\n              &times;\n            </button>\n          </div>\n        </div>\n        \n        <form onSubmit={handleSubmit} className=\"p-6\">\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              MATERIAL\n            </label>\n            <input\n              type=\"text\"\n              name=\"MATERIAL\"\n              value={formData.MATERIAL}\n              onChange={handleChange}\n              className=\"form-input\"\n              required\n            />\n          </div>\n          \n          <div className=\"grid grid-cols-2 gap-4 mb-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                UNIDADE\n              </label>\n              <input\n                type=\"text\"\n                name=\"UNIDADE\"\n                value={formData.UNIDADE}\n                onChange={handleChange}\n                className=\"form-input\"\n                required\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                QUANTIDADE\n              </label>\n              <input\n                type=\"number\"\n                name=\"QTD\"\n                value={formData.QTD}\n                onChange={handleChange}\n                className=\"form-input\"\n                min=\"0\"\n                step=\"0.01\"\n                required\n              />\n            </div>\n          </div>\n          \n          <div className=\"grid grid-cols-2 gap-4 mb-6\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                VALOR UNITÁRIO\n              </label>\n              <input\n                type=\"number\"\n                name=\"VALOR_UNITARIO\"\n                value={formData.VALOR_UNITARIO}\n                onChange={handleChange}\n                className=\"form-input\"\n                min=\"0\"\n                step=\"0.01\"\n                required\n              />\n            </div>\n            \n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                VALOR TOTAL\n              </label>\n              <div className=\"flex items-center\">\n                <input\n                  type=\"text\"\n                  value={formatCurrency(formData.VALOR)}\n                  className=\"form-input bg-gray-100\"\n                  readOnly\n                />\n                <span className=\"ml-2 text-xs text-gray-500\">(calculado)</span>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"flex justify-between\">\n            <div className=\"space-x-4\">\n              <button\n                type=\"button\"\n                className=\"btn btn-secondary\"\n                onClick={() => setShowEditItemModal(false)}\n              >\n                Cancelar\n              </button>\n              \n              {!currentItem?.isNew && (\n                <button\n                  type=\"button\"\n                  className=\"btn btn-danger\"\n                  onClick={handleDelete}\n                >\n                  Excluir\n                </button>\n              )}\n            </div>\n            \n            <button\n              type=\"submit\"\n              className=\"btn btn-primary\"\n            >\n              {currentItem?.isNew ? 'Adicionar' : 'Salvar Alterações'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default EditItemModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}